"0","##TODO 13.6: Fit a logistic regression model with `Lag1` as the only predictor, and display the confusion matrix and the percent of correct predictions."
"0","lr.all <- glm(Direction ~ Lag1, data = Weekly.train, family = ""binomial"" )"
"0","summary(lr.all)"
"1","
Call:
"
"1","glm(formula = Direction ~ Lag1, family = ""binomial"", data = Weekly.train)"
"1","

"
"1","Deviance Residuals: 
"
"1","   Min  "
"1","    1Q  "
"1","Median  "
"1","    3Q  "
"1","   Max  "
"1","
"
"1","-1.519  "
"1","-1.253  "
"1"," 1.028  "
"1"," 1.094  "
"1"," 1.281  "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)"
"1","  0.21829"
"1","    0.06438"
"1","   3.391"
"1"," 0.000697"
"1"," ***"
"1","
Lag1       "
"1"," -0.05908"
"1","    0.02892"
"1","  -2.043"
"1"," 0.041059"
"1"," *  "
"1","
"
"1","---
Signif. codes:  "
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1","binomial"
"1"," family taken to be "
"1","1"
"1",")

"
"1","    Null deviance: 1354.7  on 984  degrees of freedom
"
"1","Residual deviance: 1350.4  on 983  degrees of freedom
"
"1","AIC: "
"1","1354.4"
"1","

"
"1","Number of Fisher Scoring iterations: "
"1","4"
"1","
"
"1","
"
"0","pred <- predict(lr.all, Weekly.test, type = ""response"")"
"0","pred.1 <- rep(""No"", length(pred))"
"0","pred.1[pred > 0.5] <- ""Yes"""
"0","x.2 <- table(pred.1, Weekly.test$Direction)"
"0","x.2"
"1","      
"
"1","pred.1"
"1"," Down"
"1"," Up"
"1","
   No "
"1","    4"
"1","  6"
"1","
   Yes"
"1","   39"
"1"," 55"
"1","
"
"0","percent.correct(x.2)"
"1","[1]"
"1"," 56.73077"
"1","
"
