"0","##TODO 13.7: Fit a logistic regression model with `Lag2` as the only predictor, and display the confusion matrix and the percent of correct predictions."
"0","lr.all <- glm(Direction ~ Lag2, data = Weekly.train, family = ""binomial"" )"
"0","summary(lr.all)"
"1","
Call:
"
"1","glm(formula = Direction ~ Lag2, family = ""binomial"", data = Weekly.train)"
"1","

"
"1","Deviance Residuals: 
"
"1","   Min  "
"1","    1Q  "
"1","Median  "
"1","    3Q  "
"1","   Max  "
"1","
"
"1","-1.536  "
"1","-1.264  "
"1"," 1.021  "
"1"," 1.091  "
"1"," 1.368  "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","   "
"1","
(Intercept)"
"1","  0.20326"
"1","    0.06428"
"1","   3.162"
"1","  0.00157"
"1"," **"
"1","
Lag2       "
"1","  0.05810"
"1","    0.02870"
"1","   2.024"
"1","  0.04298"
"1"," * "
"1","
"
"1","---
Signif. codes:  "
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1","binomial"
"1"," family taken to be "
"1","1"
"1",")

"
"1","    Null deviance: 1354.7  on 984  degrees of freedom
"
"1","Residual deviance: 1350.5  on 983  degrees of freedom
"
"1","AIC: "
"1","1354.5"
"1","

"
"1","Number of Fisher Scoring iterations: "
"1","4"
"1","
"
"1","
"
"0","pred <- predict(lr.all, Weekly.test, type = ""response"")"
"0","pred.1 <- rep(""No"", length(pred))"
"0","pred.1[pred > 0.5] <- ""Yes"""
"0","x.3 <- table(pred.1, Weekly.test$Direction)"
"0","x.3"
"1","      
"
"1","pred.1"
"1"," Down"
"1"," Up"
"1","
   No "
"1","    9"
"1","  5"
"1","
   Yes"
"1","   34"
"1"," 56"
"1","
"
"0","percent.correct(x.3)"
"1","[1]"
"1"," 62.5"
"1","
"
