"0","##TODO 13.8: Fit a logistic regression model with `Volume` as the only predictor, and display the confusion matrix and the percent of correct predictions."
"0","lr.all <- glm(Direction ~ Volume, data = Weekly.train, family = ""binomial"" )"
"0","summary(lr.all)"
"1","
Call:
"
"1","glm(formula = Direction ~ Volume, family = ""binomial"", data = Weekly.train)"
"1","

"
"1","Deviance Residuals: 
"
"1","   Min  "
"1","    1Q  "
"1","Median  "
"1","    3Q  "
"1","   Max  "
"1","
"
"1","-1.302  "
"1","-1.271  "
"1"," 1.060  "
"1"," 1.080  "
"1"," 1.303  "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)"
"1","  0.29405"
"1","    0.08899"
"1","   3.304"
"1"," 0.000952"
"1"," ***"
"1","
Volume     "
"1"," -0.06954"
"1","    0.05089"
"1","  -1.367"
"1"," 0.171778"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1","binomial"
"1"," family taken to be "
"1","1"
"1",")

"
"1","    Null deviance: 1354.7  on 984  degrees of freedom
"
"1","Residual deviance: 1352.8  on 983  degrees of freedom
"
"1","AIC: "
"1","1356.8"
"1","

"
"1","Number of Fisher Scoring iterations: "
"1","3"
"1","
"
"1","
"
"0","pred <- predict(lr.all, Weekly.test, type = ""response"")"
"0","pred.1 <- rep(""No"", length(pred))"
"0","pred.1[pred > 0.5] <- ""Yes"""
"0","x.4 <- table(pred.1, Weekly.test$Direction)"
"0","x.4"
"1","      
"
"1","pred.1"
"1"," Down"
"1"," Up"
"1","
   No "
"1","   31"
"1"," 47"
"1","
   Yes"
"1","   12"
"1"," 14"
"1","
"
"0","percent.correct(x.4)"
"1","[1]"
"1"," 43.26923"
"1","
"
